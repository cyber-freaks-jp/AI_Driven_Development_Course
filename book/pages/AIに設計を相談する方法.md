# AIに設計を相談する方法

設計段階では、技術選定やアーキテクチャ決定など、判断に迷う場面が多くあります。こうした場面でAIを相談相手として活用することで、より良い設計判断ができます。

## なぜAIに設計を相談すべきか

### AIの強み

- **豊富な知識**: 最新の技術トレンドやベストプラクティスを知っている
- **客観的な視点**: バイアスなく複数の選択肢を提示できる
- **即座にフィードバック**: 人間のレビューを待つ必要がない
- **具体的な提案**: 実装例やコードサンプルも提示できる

### 人間の判断との組み合わせ

AIはあくまで**相談相手**です。最終判断は人間が行うべきですが、AIの提案を参考にすることで、より良い判断ができます。

## 相談のシーン別プロンプト例

### シーン1：技術選定で迷っている

```
プロンプト例：
「タスク管理アプリのバックエンドを実装します。
以下の2つの選択肢で迷っています：
1. Node.js + Express + TypeScript
2. Python + FastAPI

以下の観点で比較してください：
- 開発速度
- パフォーマンス
- エコシステム（ライブラリの充実度）
- チームの学習コスト（JavaScriptは経験あり、Pythonは未経験）
- 長期的な保守性

プロジェクトの規模は中規模（〜10万行）で、
チームは3名、開発期間は3ヶ月です。」
```

AIの回答例：

```markdown
## 技術選定の比較

| 観点 | Node.js + Express | Python + FastAPI | 推奨 |
|------|------------------|-----------------|------|
| 開発速度 | ◎ 高速 | ◎ 高速 | 引き分け |
| パフォーマンス | ○ 良好 | ○ 良好 | 引き分け |
| エコシステム | ◎ 非常に充実 | ○ 充実 | Node.js |
| 学習コスト | ◎ 低い | △ 高い | Node.js |
| 保守性 | ○ 良好 | ○ 良好 | 引き分け |

**推奨: Node.js + Express + TypeScript**

理由：
1. チームが既にJavaScriptの経験があるため、学習コストが低い
2. 開発期間が3ヶ月と短いため、新技術の学習時間を削減すべき
3. npmエコシステムは非常に充実しており、必要なライブラリがすぐ見つかる
4. TypeScriptにより型安全性が確保され、保守性も高い

ただし、Pythonを選ぶべきケース：
- 機械学習やデータ分析機能が必要な場合
- チーム全員がPython学習に前向きな場合
```

### シーン2：アーキテクチャ設計の妥当性を確認

```
プロンプト例：
「@Docs/設計書.md のアーキテクチャを確認してください。
以下の観点でレビューしてください：
- 3層アーキテクチャの設計は適切か
- セキュリティ上の懸念はないか
- スケーラビリティは確保されているか
- より良い代替案はあるか」
```

### シーン3：データベース設計の相談

```
プロンプト例：
「タスク管理アプリのデータベース設計について相談です。
現在、以下のテーブル構成を考えています：
- USER（id, email, password_hash）
- TASK（id, user_id, title, description, priority, deadline）
- COMMENT（id, task_id, user_id, content）

以下の要件を満たすために、どのような改善が必要ですか？
- タスクを複数のユーザーで共有したい
- タスクにタグを付けたい
- タスクの変更履歴を保存したい

ER図をMermaid形式で提案してください。」
```

AIが改善案を提示してくれます：

```markdown
## 改善されたデータベース設計

\`\`\`mermaid
erDiagram
    USER ||--o{ TASK_ASSIGNMENT : assigns
    TASK ||--o{ TASK_ASSIGNMENT : has
    TASK ||--o{ COMMENT : has
    TASK ||--o{ TASK_TAG : has
    TAG ||--o{ TASK_TAG : has
    TASK ||--o{ TASK_HISTORY : tracks
    
    TASK_ASSIGNMENT {
        uuid task_id FK
        uuid user_id FK
        varchar role
    }
    
    TAG {
        uuid id PK
        varchar name UK
    }
    
    TASK_TAG {
        uuid task_id FK
        uuid tag_id FK
    }
    
    TASK_HISTORY {
        uuid id PK
        uuid task_id FK
        uuid user_id FK
        json changes
        timestamp created_at
    }
\`\`\`

**変更点**：
1. TASK_ASSIGNMENT テーブルを追加（多対多の関係）
2. TAG と TASK_TAG テーブルを追加（タグ機能）
3. TASK_HISTORY テーブルを追加（変更履歴）
```

### シーン4：パフォーマンス最適化の相談

```
プロンプト例：
「タスク一覧取得APIが遅いです。
@src/routes/tasks.ts のコードを確認してください。
N+1クエリ問題が発生していないか、
インデックスは適切か、
キャッシュを活用すべきか、
具体的な改善案を提示してください。」
```

### シーン5：セキュリティ設計の相談

```
プロンプト例：
「@Docs/設計書.md のセキュリティ設計を確認してください。
OWASP Top 10 の観点で、以下を確認してください：
- SQLインジェクション対策
- XSS対策
- CSRF対策
- 認証・認可の実装
- データ暗号化

不足している対策があれば、具体的な実装方法を提案してください。」
```

## 効果的な相談のコツ

### 1. コンテキストを十分に提供する

❌ 悪い例：
```
「データベース設計はこれで良いですか？」
```

✅ 良い例：
```
「@Docs/設計書.md のデータベース設計を確認してください。
要件として、タスクを複数ユーザーで共有する必要があります。
現在の設計で実現可能か、改善案があれば提案してください。」
```

### 2. 具体的な観点を指定する

❌ 悪い例：
```
「この設計で問題ないですか？」
```

✅ 良い例：
```
「以下の観点でレビューしてください：
- パフォーマンス
- セキュリティ
- スケーラビリティ
- 保守性」
```

### 3. プロジェクトの制約を伝える

```
✅ 良い例：
「チームは3名、開発期間は3ヶ月、
全員がNode.jsの経験はあるがPythonは未経験です。
この前提で、バックエンドの技術選定を相談したいです。」
```

### 4. 複数の選択肢を提示する

```
✅ 良い例：
「以下の3つの選択肢で迷っています：
1. PostgreSQL（リレーショナルDB）
2. MongoDB（ドキュメントDB）
3. DynamoDB（マネージドNoSQL）

タスク管理アプリの特性を考慮して、推奨を教えてください。」
```

## マークダウン形式だからこそ効果的

設計書がマークダウン形式だからこそ、AIへの相談が効果的になります。

### Before（Excel/Word）

```
設計書.xlsx → コピペして質問 → AIが正確に読み取れない → 再質問
```

### After（マークダウン）

```
@Docs/設計書.md → AIが完璧に理解 → 的確なフィードバック
```

## 相談結果を設計書に反映

AIからのフィードバックを受けて、設計書を更新します。

```
プロンプト例：
「先ほどの提案を @Docs/設計書.md に反映してください。
特に以下を更新してください：
- データベース設計のER図
- TASK_ASSIGNMENT テーブルの定義
- TAG テーブルの定義
- TASK_HISTORY テーブルの定義」
```

## まとめ

| 相談内容 | プロンプトのコツ |
|---------|---------------|
| 技術選定 | 観点を明確に、制約条件を伝��る |
| アーキテクチャ | @記法で設計書を参照させる |
| データベース設計 | 要件と現状の課題を具体的に |
| パフォーマンス | コードを参照させ、具体的な改善を求める |
| セキュリティ | OWASP Top 10など基準を指定 |

**重要なポイント**

- マークダウン形式の設計書だからAIに正確に伝わる
- @記法で設計書を参照させる
- 具体的な観点を指定する
- プロジェクトの制約を伝える
- AIの提案を鵜呑みにせず、人間が最終判断する
- フィードバックを設計書に反映する

次のセクションでは、設計書をもとにAIで実装を自動化する方法を学びます。
