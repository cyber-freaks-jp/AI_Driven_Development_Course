# ルールファイルの設定

## ルールファイルとは

ルールファイルとは、**AIに対してプロジェクト固有のルールを事前に伝えるためのマークダウンファイル**です。


### なぜルールファイルが必要なのか

AIツールは様々なプロジェクトで使われるため、デフォルトでは汎用的な動作をします。しかし、実際の開発では様々な独自ルールが存在します。

- プロジェクトごとにコーディング規約が異なる
- 使用する技術スタックが違う
- 禁止事項や制約がある
- チーム独自のルールが存在する

**ルールファイルを設定することで、AIがそのルールに従って動作するようになります。**


## ルールファイルを設定するメリット

### メリット1：毎回同じ指示を繰り返さなくて良い

**ルールファイルなし：**

```
あなた：「ログイン機能を実装して。TypeScriptで、ESLint準拠で、
        JSDocも書いて、エラーハンドリングも忘れずに」
```

毎回これらの指示を繰り返す必要があります。

**ルールファイルあり：**

```markdown
# CLAUDE.md
## コーディング規約
- TypeScript strict mode
- ESLint準拠
- すべての関数にJSDoc
- エラーハンドリング必須
```

```
あなた：「ログイン機能を実装して」
```

たったこれだけで、AIがルールファイルに従って実装してくれます。

### メリット2：一貫性のあるコードが生成される

ルールファイルがあることで、**誰がAIに指示しても同じ品質のコードが生成**されます。

チーム開発では、メンバーごとに指示の仕方が異なると、生成されるコードの品質にばらつきが出ます。ルールファイルを共有することで、この問題を解決できます。

### メリット3：禁止事項を明確にできる

AIは強力ですが、誤って危険な操作をしてしまう可能性もあります。

```markdown
## 禁止事項
- git push（レビュー前のプッシュ禁止）
- sudo コマンド（システム設定変更禁止）
- プロジェクト外のファイル操作
- 本番環境への接続
```

このように禁止事項を明記することで、**AIが誤って危険な操作をすることを防げます。**

### メリット4：プロジェクトの技術スタックを理解させられる

```markdown
## 技術スタック
- フロントエンド：React 18 + TypeScript
- 状態管理：Zustand
- スタイリング：Tailwind CSS
- テスト：Vitest + Testing Library
- バックエンド：Node.js + Express
- データベース：PostgreSQL
```

このように技術スタックを明記すると、AIが適切な技術を選択してコードを生成します。

## エディタによる設定方法の違い

ルールファイルの**設定場所やファイル名は、使用するエディタやツールによって異なります。**

| ツール | ルールファイル名 | 配置場所 |
|--------|----------------|----------|
| Cursor | `.cursorrules` | プロジェクトルート |
| Claude Code | `CLAUDE.md` | プロジェクトルート |
| その他 | ツールによる | 各ツールのドキュメント参照 |

**自分が使っているツールのルールファイルの設定方法は、必ず公式ドキュメントや検索で調べてください。**

例えば：
- 「Cursor ルールファイル 設定方法」
- 「Claude Code ルールファイル」
- 「Windsurf cursorrules」

のように検索すると、具体的な設定方法が見つかります。

## Claude Codeでの設定方法

ここでは、Claude Codeを例に具体的な設定方法を説明します。

### 手順1：CLAUDE.mdを作成

プロジェクトのルートディレクトリに `CLAUDE.md` というファイルを作成します。

```bash
# プロジェクトルートで実行
touch CLAUDE.md
```

### 手順2：ルールを記述

作成した `CLAUDE.md` に、マークダウン形式でルールを記述します。

**基本的な構成例：**

```markdown
# プロジェクトルール

## プロジェクト概要
このプロジェクトは、タスク管理アプリです。
React + TypeScript + Tailwind CSSで構築されています。

## 技術スタック
- フロントエンド：React 18 + TypeScript
- スタイリング：Tailwind CSS
- テスト：Vitest
- パッケージマネージャー：npm

## コーディング規約
- TypeScript strict mode を使用
- ESLint準拠
- すべての関数にJSDocコメントを記述
- エラーハンドリングを必ず実装
- テストコードも一緒に生成

## 禁止事項
- プロジェクト外のファイル操作
- git push（レビュー前）
- sudo コマンド
- 本番環境への接続

## コミットメッセージ
- 日本語で記述
- 形式：[種別] 変更内容
- 種別：feat, fix, refactor, test, docs
```

### 手順3：動作確認

Claude Codeを起動して、簡単な指示を出してみます。

```bash
claude
```

```
あなた：「Todoリストのコンポーネントを作成して」

Claude Code：
  ✓ src/components/TodoList.tsxを作成
  ✓ TypeScript strict mode
  ✓ JSDocコメント付き
  ✓ エラーハンドリング実装
  ✓ テストファイルも生成
```

ルールファイルに従って、指定したルール通りにコードが生成されます。

### 手順4：必要に応じて更新

プロジェクトの進行に応じて、ルールファイルを更新していきます。

```markdown
## 新規追加：アクセシビリティ
- すべてのインタラクティブ要素にaria-label
- キーボード操作対応必須
```

このように、**プロジェクトの成長に合わせてルールファイルも育てていく**ことが重要です。

## ルールファイル設定のコツ

### コツ1：最初はシンプルに始める

最初から完璧なルールファイルを作ろうとしないことです。

**推奨する最初のルールファイル：**

```markdown
# プロジェクトルール

## 技術スタック
- [使用している技術を列挙]

## コーディング規約
- [最低限のルール2〜3個]

## 禁止事項
- git push
- sudo コマンド
```

このくらいシンプルなところから始めて、必要に応じて追加していきます。

### コツ2：AIとの対話で改善する

ルールファイル自体も、AIに手伝ってもらって作成・改善できます。

```
あなた：「このプロジェクトに最適なCLAUDE.mdを提案して」

AI：
  プロジェクトの内容を分析して、適切なルールファイルを提案
```

AIが提案した内容をベースに、自分のプロジェクトに合わせてカスタマイズしていきましょう。

### コツ3：具体的に書く

抽象的なルールではなく、具体的なルールを書きます。

**悪い例：**
```markdown
- きれいなコードを書く
- わかりやすくする
```

**良い例：**
```markdown
- 関数は1つの責務のみを持つ（単一責任の原則）
- 変数名は省略せず、意味が明確にわかる名前にする
- 複雑な処理には必ずコメントを記述
```

### コツ4：チームで共有する

ルールファイルは、**Gitで管理してチーム全体で共有**します。

```bash
# ルールファイルをコミット
git add CLAUDE.md
git commit -m "feat: プロジェクトのルールファイルを追加"
git push
```

これにより、チーム全員が同じルールでAIを活用できます。

### コツ5：定期的に見直す

プロジェクトは成長します。それに合わせて、**ルールファイルも定期的に見直し**ます。

```mermaid
graph LR
    A[ルールファイル作成] --> B[運用]
    B --> C[問題点の発見]
    C --> D[ルールを改善]
    D --> B
```

月に1回など、定期的に見直す機会を設けると良いでしょう。

### コツ6：サンプルから学ぶ

他のプロジェクトのルールファイルを参考にすると、効率的に学べます。

GitHubで公開されているプロジェクトの中には、ルールファイルを公開しているものもあります。

```
検索例：
- "CLAUDE.md site:github.com"
- ".cursorrules example"
```

ただし、そのままコピーするのではなく、**自分のプロジェクトに合わせてカスタマイズ**することが重要です。

## ルールファイルの実践例

実際のプロジェクトで使われるルールファイルの例を紹介します。

### 例1：小規模なWebアプリケーション

```markdown
# プロジェクトルール

## プロジェクト概要
個人ブログシステム（Next.js）

## 技術スタック
- Next.js 14（App Router）
- TypeScript
- Tailwind CSS
- Prisma + PostgreSQL

## コーディング規約
- すべてのコンポーネントは関数コンポーネント
- Server ComponentsとClient Componentsを明確に区別
- 型定義は必ず明示的に記述
- エラーは適切にハンドリング

## ディレクトリ構造
- /app：ページとレイアウト
- /components：再利用可能なコンポーネント
- /lib：ユーティリティ関数
- /prisma：データベーススキーマ

## 禁止事項
- git push（レビュー前）
- process.env を直接参照（環境変数は /lib/env.ts 経由）
```

### 例2：チーム開発のプロジェクト

```markdown
# プロジェクトルール

## プロジェクト概要
ECサイトのバックエンドAPI

## 技術スタック
- Node.js + Express
- TypeScript
- Prisma + MySQL
- Jest（テスト）

## コーディング規約
- ESLint + Prettier 準拠
- すべての関数にJSDoc
- テストカバレッジ80%以上
- APIレスポンスは必ず統一フォーマット

## セキュリティルール
- 環境変数に機密情報を保存
- すべてのエンドポイントで認証チェック
- SQLインジェクション対策必須
- XSS対策必須

## テスト
- すべての新規機能にテストを追加
- テストが通らない場合はコミット禁止

## 禁止事項
- console.log（本番コードに含めない）
- git push main（mainブランチへの直接プッシュ禁止）
- sudo コマンド
```

## まとめ

ルールファイルは、AI駆動開発をより効率的にする強力なツールです。

**ルールファイルの要点：**

1. **定義**：AIにプロジェクトのルールを事前に伝えるファイル
2. **メリット**：
   - 毎回同じ指示を繰り返さなくて良い
   - 一貫性のあるコードが生成される
   - 禁止事項を明確にできる
   - プロジェクトの技術スタックを理解させられる

3. **設定方法**：
   - エディタによって異なる（Cursor: `.cursorrules`, Claude Code: `CLAUDE.md`）
   - 各ツールの公式ドキュメントを確認する

4. **設定のコツ**：
   - 最初はシンプルに始める
   - AIと対話して改善する
   - 具体的に書く
   - チームで共有する
   - 定期的に見直す
   - サンプルから学ぶ

ルールファイルを活用することで、**AIがあなたのプロジェクト専用のアシスタント**として働いてくれるようになります。
