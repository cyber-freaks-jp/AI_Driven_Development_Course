# AIはサンドボックス環境で動かすのがオススメ

**AIはサンドボックス環境で動かすことを強くお勧めします。その理由は2つあります：**

1. **セキュリティリスクの回避**：情報漏洩やコード破壊といったリスクを完全に防げる
2. **生産性の爆発的向上**：AIの完全自律実行モードを安全に使える

## サンドボックス環境とは

**サンドボックス環境＝本番環境から完全に隔離された環境**

ローカル開発環境として作成するDocker環境は、サンドボックス環境の代表格です。

具体的には：
- 壊れても問題のない環境（Dockerコンテナ等）
- 本番DB、本番サーバーへの通信が遮断されている
- いつでも作り直せる使い捨て環境

**加えて、重要な運用ルール：**
- サンドボックス環境に持ち込むデータは、**必ず機密情報をマスキング**する
  - 例：メールアドレスを `test@example.com` に置換
  - 例：決済情報テーブルを除外
  - 例：APIキーをダミー値に置換

**それでは、サンドボックス環境の2つのメリットについて見ていきましょう。**

## メリット1：セキュリティリスクの回避

AI駆動開発には、大きく分けて2つのセキュリティリスクがあります：

1. **情報漏洩**：AIプロバイダーへの機密情報・個人情報の送信
2. **コード/データ破壊**：AIが生成した破壊的なコードの実行（`rm -rf /`、`DROP DATABASE`等）

サンドボックス環境を使えば、これらのリスクを回避できます。

### リスク1：情報漏洩

**問題**：本番環境の個人情報・機密情報がAIプロバイダーに送信されてしまう

**解決策**：

AIの手が届くところに、機密情報を置くのは運用で禁止します。
つまり、AIは通信が隔離されたサンドボックス上でのみ動かし、そこには機密情報を置かないルールにします。

### リスク2：コード/データ破壊

**問題**：AIが生成した破壊的なコードが実行されてしまう

例えば、AIが以下のような破壊的なコードを生成する可能性があります：
- `rm -rf /` でシステム全体が削除される
- 本番DBがUPDATE文で勝手に更新されてしまう
- 外部APIを勝手に実行してしまう

**解決策**：

サンドボックス環境でAIを実行すれば、これらのリスクは100%回避できます。

そのためにも、サンドボックス環境は本番環境に通信できないよう隔離します。
もちろんSSH接続も出来ないようにします。

## サンドボックス環境のメリット2：生産性の爆発的向上

通常、AIは危険なコマンドを実行する際、人間に確認を求めます：

```
AI: 「rm -rf /tmp/old_files を実行してもよろしいですか？」
```

この確認作業は安全ですが、毎回確認を求められるため自律性が低く、**生産性が低い**です。
それを解消するのが「完全自立実行モード」です

### 完全自律実行モードとは

Claude Codeのような自律性の高いAIには、**完全自律実行モード**があります：

```bash
# 人間の許可を求めずに完全自律実行
claude --dangerously-skip-permissions
```

このモードでは：
- AIが人間に確認を求めない
- あなたが寝ている間もAIがタスクを進める
- 人間が張り付いて監視することから解放されるので、別の仕事に集中できる
- **生産性が桁違いに向上する**

### 完全自律実行モードのリスク

ただし、このモードは**非常に危険**です。
例え個人開発だとしても、 

```
rm -rf /
```

コマンドであなたのパソコンを壊してしまうかもしれません。
リスク管理は、**AIが暴走して何をやらかすかわからない**という前提で考えるべきです。

### サンドボックス環境なら安全に使える

サンドボックス環境であれば、AIが暴走してもノーリスクです。だからこそ、完全自律実行モードを安全に使えるようになります。

**これが、サンドボックス環境でAIを動かすことを強く強くお勧めする理由です。**

## まとめ

### サンドボックス環境の定義（再確認）

サンドボックス環境とは：

1. **隔離された環境**（本番から分離）
2. **本番への通信遮断**（本番DB・サーバーにアクセス不可）
3. **機密情報のマスキング**（個人情報・機密情報を除外/置換）

**この3つを満たすことで、リスク1（情報漏洩）とリスク2（コード/データ破壊）に対応できます。**

### 2つのリスクへの対応

| リスク | サンドボックスでの対応 | 具体的な方法 |
|-------|-----------------|------------|
| **リスク1：情報漏洩** | ✅ 対応可能 | 機密情報をマスキングしてから持ち込む（サンドボックスの定義の一部） |
| **リスク2：コード/データ破壊** | ✅ 対応可能 | 隔離環境で実行し、本番との通信を遮断 |

### サンドボックス環境使用時の重要原則

1. **本番環境で直接AIツールを使わない**
2. **ローカル環境でもサンドボックス環境を使う**
3. **機密情報を必ずマスキングする**

詳細なセキュリティ原則と本番バグ調査の実践方法については、**[本番環境でのバグ調査](./本番環境でのバグ調査.md)**ページを参照してください。

### サンドボックス環境の利点

1. **機密情報漏洩を防ぐ**（リスク1対応）← マスキングを徹底
2. **AIの破壊的なコードから本番環境を保護**（リスク2対応）
3. **本番データを安全に調査できる**（リスク2対応）
4. **完全自律実行モードが使える**（生産性が爆発的に向上）
5. 簡単にリセット可能
6. リソース制限でシステムダウンを防止
7. 権限を最小化してセキュリティ向上

**サンドボックス環境を正しく構築・運用することで、AI駆動開発の主要なセキュリティリスク（情報漏洩・コード破壊）に対応できます。特に、機密情報のマスキングはサンドボックス環境の必須要件です。**
