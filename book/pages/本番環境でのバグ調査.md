# 本番環境でのバグ調査

本番環境で発生したバグは緊急性があるのですぐに解決したいですよね。
**本番環境の情報をAIに渡すことができれば、迅速に解決できます。**

### 本番環境の情報とは

AIに渡すべき「本番環境の情報」には、以下のような情報が含まれます：

- データベースのダンプデータ
- 各種ログ
- インフラのメトリクス（CPU、メモリ、ネットワーク使用率）
- ミドルウェアの設定ファイル（Nginx、MySQL、Redis設定など）
- クラウドリソース情報（AWSのEC2設定、Security Group等）

これらの情報をAIに与えることで、以下のようなバグを調査できます：

| バグの種類          | AIが分析する情報                 |
| -------------- | ------------------------- |
| **アプリケーションバグ** | ログ + DB + コード             |
| **インフラ障害**     | EC2設定 + ミドルウェア設定 + システムログ |
| **パフォーマンス問題**  | メトリクス + スロークエリログ + コード    |

## ただし、セキュリティリスクがある

本番環境のデータには、個人情報や機密情報が含まれています。
**そのため、本番環境で直接AIツールを使うことは絶対にやめましょう**

では、どうすれば安全にAIを活用できるのか？
答えは、「本番環境の情報を、安全な隔離環境にコピーしてからAIに渡す」**ことです

## 本番の情報を安全にAIに渡す方法のアイデア

運用現場によって対応方法は変わりますが、以下のようなアイデアが考えられます。

### アイデア1：サンドボックス環境にデータをコピー

本番のデータベースやAPIにアクセスできない、隔離された「サンドボックス環境」を用意し、その環境に本番のデータをコピーする方法があります

このサンドボックス環境は、ローカルのDocker環境でも構いません

とにかく、
- 本番へ影響を与えない
- AIが暴走して何をやっても大丈夫な環境
なら、どこでもOKです


**イメージ**：
```
本番DB → ダンプ取得 → サンドボックスDBに復元
本番ログ → サンドボックスDBにコピー
```


このような環境でAIにバグの調査依頼を出すことで、本番環境でのバグを迅速に調査することが可能になります

⚠️注意点：
* 本番の機密データは必要に応じて潰しましょう。例えば、DBのUserテーブルに個人情報がある場合は、それをローカル環境に移行する際、SQL文で個人情報をダミーデータに置換するなどセキュリティの考慮をしましょう

### アイデア2：本番EC2インスタンスのコピー環境を作る

例えばAWSの場合、本番EC2インスタンスをコピーすることで、より本番に近いサンドボックス環境を作ることができます。
これなら、インフラレベルの障害調査もしやすくなります。

注意点として、本番DBやAPIへのアクセスを遮断するなど、AIがいくら暴走しても本番には影響を与えないような隔離環境にしましょう

---

**重要**：どの方法を使うかは、組織のセキュリティポリシーや運用ルールによって異なります。**必ず上司やセキュリティ担当者に相談してから実施してください。**


## 重要なセキュリティ原則

本番環境のコンテキストをAIに渡す際は、**セキュリティに細心の注意を払う必要があります。**

**重要なポイント**：
- 本番環境で直接AIツールを使わない
- ローカル環境でもサンドボックス環境を使う
- 機密情報を除外・マスキングする
- 本番への通信を遮断する
- 必ず上司・セキュリティ担当に相談する

詳細なセキュリティ原則と具体的な実装方法については、**[サンドボックス環境の構築](./サンドボックス環境の構築.md)**ページを参照してください。


## まとめ

本番環境のコンテキスト（ログ、DB、インフラ情報）をAIに安全に渡すことができれば、本番で発生したバグであってもAIで迅速に解決できます。

### 重要なポイント

1. **AIに「本番環境の状態」を再現できる情報を渡すことが鍵**
2. **どの方法を使うかは、組織のポリシーによって異なる**
3. **必ずセキュリティに配慮し、上司に相談する**

